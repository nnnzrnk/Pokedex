let pokemonRepository = (function () {
  let e = [];
  function t() {
    return e;
  }
  function n(t) {
    "object" == typeof t && "name" in t && "detailsUrl" in t
      ? e.push(t)
      : console.log("Please check the inputs");
  }
  function o(e) {
    i(e).then(function () {
      r(e);
    });
  }
  function i(e) {
    return fetch(e.detailsUrl)
      .then(function (e) {
        return e.json();
      })
      .then(function (t) {
        (e.imageUrl = t.sprites.other["official-artwork"].front_default),
          (e.height = t.height),
          (e.types = []);
        for (var n = 0; n < t.types.length; n++)
          e.types.push(t.types[n].type.name);
        r(e);
      })
      .catch(function (e) {
        console.error(e);
      });
  }
  function r(e) {
    document.querySelector(".modal-title").innerText = e.name;
    document.querySelector(".modal-height").innerText = `Height: ${e.height}`;
    document.querySelector(".modal-img").src = e.imageUrl;
    document.querySelector(".modal-types").innerText = `Types: ${e.types}`;
  }
  return {
    getAll: t,
    add: n,
    addListItem: function e(t) {
      let n = document.querySelector(".pokemon-list"),
        i = document.createElement("li"),
        r = document.createElement("button");
      i.classList.add("list-group-item", "col-md-4"),
        (r.innerText = t.name),
        r.classList.add("my-btn", "btn-primary"),
        r.setAttribute("data-bs-toggle", "modal"),
        r.setAttribute("data-bs-target", "#modal-container"),
        r.setAttribute("type", "button"),
        i.appendChild(r),
        n.appendChild(i),
        r.addEventListener("click", () => o(t));
    },
    find: function t(n) {
      return e.find((e) => e.name === n);
    },
    loadList: function e() {
      return fetch("https://pokeapi.co/api/v2/pokemon/?limit=150")
        .then(function (e) {
          return e.json();
        })
        .then(function (e) {
          e.results.forEach(function (e) {
            n({ name: e.name, detailsUrl: e.url });
          });
        })
        .catch(function (e) {
          console.error(e);
        });
    },
    loadDetails: i,
    showDetails: o,
  };
})();
pokemonRepository.loadList().then(function () {
  pokemonRepository.getAll().forEach(function (e) {
    pokemonRepository.addListItem(e);
  });
});
let dialogPromiseReject;
function hideModal() {
  document.querySelector("#modal-container").classList.remove("is-visible"),
    dialogPromiseReject &&
      (dialogPromiseReject(), (dialogPromiseReject = null));
}
window.addEventListener("keydown", (e) => {
  let t = $("#modal-container");
  "Escape" === e.key && t.classList.contains("is-visible") && hideModal();
});
let modalContainer = $("#modal-container");
modalContainer.addEventListener("click", (e) => {
  e.target === modalContainer && hideModal();
});
